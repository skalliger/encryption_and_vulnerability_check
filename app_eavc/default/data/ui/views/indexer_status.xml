
<dashboard version="2" theme="dark">
    <label>Indexer Status</label>
    <description>List several details of your indexer&#39;s encryption status</description>
    <definition><![CDATA[
{
	"visualizations": {
		"viz_RT30G5tI": {
			"type": "splunk.singlevalue",
			"showProgressBar": false,
			"showLastUpdated": false,
			"dataSources": {
				"primary": "ds_m4pXDoNf"
			},
			"title": "Number of Indexers"
		},
		"viz_qv1rS5t1": {
			"type": "splunk.singlevalue",
			"title": "Instances with splunktcp-ssl enabled",
			"dataSources": {
				"primary": "ds_tiBNKmRV"
			}
		},
		"viz_hzt2ByEj": {
			"type": "splunk.table",
			"title": "splunktcp Inputs",
			"dataSources": {
				"primary": "ds_X29xpq8Y"
			},
			"options": {
				"columnFormat": {
					"disabled": {
						"data": "> table | seriesByName(\"disabled\") | formatByType(disabledColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('disabled') | pick(disabledRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"disabled\") | matchValue(disabledRowBackgroundColorsEditorConfig)",
						"width": 67
					},
					"sslVersions": {
						"data": "> table | seriesByName(\"sslVersions\") | formatByType(sslVersionsColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('sslVersions') | pick(sslVersionsRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"sslVersions\") | matchValue(sslVersionsRowBackgroundColorsEditorConfig)",
						"width": 75
					},
					"Instance": {
						"width": 70
					},
					"acceptFrom": {
						"width": 65
					},
					"cipherSuite": {
						"width": 230
					},
					"ecdhCurves": {
						"width": 107
					},
					"sslCommonNameToCheck": {
						"width": 96
					},
					"requireClientCert": {
						"width": 81
					},
					"App Context": {
						"width": 80
					},
					"TLS enabled": {
						"data": "> table | seriesByName(\"TLS enabled\") | formatByType(TLS_enabledColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('TLS enabled') | pick(TLS_enabledRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"TLS enabled\") | matchValue(TLS_enabledRowBackgroundColorsEditorConfig)"
					}
				},
				"count": 5
			},
			"context": {
				"disabledColumnFormatEditorConfig": {
					"number": {
						"thousandSeparated": false,
						"unitPosition": "after"
					}
				},
				"disabledRowColorsEditorConfig": [
					"#ffffff"
				],
				"disabledRowBackgroundColorsEditorConfig": [
					{
						"match": 0,
						"value": "#2f8811"
					},
					{
						"match": 1,
						"value": "#555555"
					},
					{
						"match": "false",
						"value": "#2f8811"
					},
					{
						"match": "true",
						"value": "#555555"
					}
				],
				"sslVersionsColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"sslVersionsRowColorsEditorConfig": [
					"#ffffff"
				],
				"sslVersionsRowBackgroundColorsEditorConfig": [
					{
						"match": "sslv2",
						"value": "#78062a"
					},
					{
						"match": "sslv3",
						"value": "#78062a"
					},
					{
						"match": "tls1.1",
						"value": "#AD3F20"
					},
					{
						"match": "tls1.2",
						"value": "#2f8811"
					}
				],
				"TLS_enabledColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"TLS_enabledRowColorsEditorConfig": [
					"#ffffff"
				],
				"TLS_enabledRowBackgroundColorsEditorConfig": [
					{
						"match": "true",
						"value": "#2f8811"
					},
					{
						"match": "false",
						"value": "#78062a"
					}
				]
			}
		},
		"viz_iKQAtYaT": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_4ephixIX"
			},
			"title": "Indexes with enableDataIntegrityControl = false"
		},
		"viz_pieH0lXZ": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_dubEkho7"
			},
			"title": "Indexes with enableDataIntegrityControl = true"
		},
		"viz_1ESFgaWf": {
			"type": "splunk.table",
			"dataSources": {
				"primary": "ds_ezIITtPe"
			},
			"title": "HEC Token Status",
			"options": {
				"columnFormat": {
					"enableSSL": {
						"data": "> table | seriesByName(\"enableSSL\") | formatByType(enableSSLColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('enableSSL') | pick(enableSSLRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"enableSSL\") | matchValue(enableSSLRowBackgroundColorsEditorConfig)"
					},
					"useACK": {
						"data": "> table | seriesByName(\"useACK\") | formatByType(useACKColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName(\"useACK\") | matchValue(useACKRowColorsEditorConfig)"
					},
					"sslVersions": {
						"data": "> table | seriesByName(\"sslVersions\") | formatByType(sslVersionsColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('sslVersions') | pick(sslVersionsRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"sslVersions\") | matchValue(sslVersionsRowBackgroundColorsEditorConfig)"
					},
					"forceHttp10": {
						"data": "> table | seriesByName(\"forceHttp10\") | formatByType(forceHttp10ColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('forceHttp10') | pick(forceHttp10RowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"forceHttp10\") | matchValue(forceHttp10RowBackgroundColorsEditorConfig)"
					},
					"allowSslRenegotiation": {
						"data": "> table | seriesByName(\"allowSslRenegotiation\") | formatByType(allowSslRenegotiationColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('allowSslRenegotiation') | pick(allowSslRenegotiationRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"allowSslRenegotiation\") | matchValue(allowSslRenegotiationRowBackgroundColorsEditorConfig)",
						"width": 112
					},
					"sslCommonNameToCheck": {
						"width": 100
					}
				},
				"count": 5
			},
			"context": {
				"enableSSLColumnFormatEditorConfig": {
					"number": {
						"thousandSeparated": false,
						"unitPosition": "after"
					}
				},
				"enableSSLRowColorsEditorConfig": [
					"#ffffff"
				],
				"enableSSLRowBackgroundColorsEditorConfig": [
					{
						"match": 0,
						"value": "#78062a"
					},
					{
						"match": 1,
						"value": "#2f8811"
					},
					{
						"match": "false",
						"value": "#78062a"
					},
					{
						"match": "true",
						"value": "#2f8811"
					}
				],
				"useACKColumnFormatEditorConfig": {
					"number": {
						"thousandSeparated": false,
						"unitPosition": "after"
					}
				},
				"useACKRowColorsEditorConfig": [
					{
						"match": 0,
						"value": "#555555"
					},
					{
						"match": 1,
						"value": "#555555"
					},
					{
						"match": "false",
						"value": "#555555"
					},
					{
						"match": "true",
						"value": "#555555"
					}
				],
				"sslVersionsColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"sslVersionsRowColorsEditorConfig": [
					"#ffffff"
				],
				"sslVersionsRowBackgroundColorsEditorConfig": [
					{
						"match": "tls1.2",
						"value": "#2f8811"
					},
					{
						"match": "tls1.1",
						"value": "#ad3f20"
					},
					{
						"match": "tls1.0",
						"value": "#78062a"
					}
				],
				"forceHttp10ColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"forceHttp10RowColorsEditorConfig": [
					"#ffffff"
				],
				"forceHttp10RowBackgroundColorsEditorConfig": [
					{
						"match": "never",
						"value": "#2f8811"
					},
					{
						"match": "auto",
						"value": "#ad3f20"
					},
					{
						"match": "always",
						"value": "#78062a"
					}
				],
				"allowSslRenegotiationColumnFormatEditorConfig": {
					"number": {
						"thousandSeparated": false,
						"unitPosition": "after"
					}
				},
				"allowSslRenegotiationRowColorsEditorConfig": [
					"#ffffff"
				],
				"allowSslRenegotiationRowBackgroundColorsEditorConfig": [
					{
						"match": 0,
						"value": "#2f8811"
					},
					{
						"match": 1,
						"value": "#78062a"
					},
					{
						"match": "false",
						"value": "#2f8811"
					},
					{
						"match": "true",
						"value": "#78062a"
					}
				]
			}
		},
		"viz_ZvFciRgB": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_374YUX51"
			},
			"title": "Number of indexes"
		},
		"viz_Iu62dB0A": {
			"type": "splunk.table",
			"dataSources": {
				"primary": "ds_gg3wvzRH"
			},
			"title": "Indexer Cluster Status",
			"description": "empty if no indexer cluster was found"
		},
		"viz_GEuYdlpS": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_ZLTPHf3t"
			},
			"title": "Indexers with UI disabled"
		}
	},
	"dataSources": {
		"ds_m4pXDoNf": {
			"type": "ds.search",
			"options": {
				"query": "index=_internal component=\"Metrics\" instance_roles=*\n| fields server_name, instance_roles\n| dedup server_name\n| regex instance_roles=\"(indexer)\"\n| stats count",
				"queryParameters": {
					"earliest": "-24h@h",
					"latest": "now"
				}
			},
			"name": "get_all_idx"
		},
		"ds_4ephixIX": {
			"type": "ds.chain",
			"options": {
				"query": "| where enableDataIntegrityControl=0 OR enableDataIntegrityControl LIKE \"false\"\n| stats latest(indexCount) AS cDIC\n| appendpipe [stats count | where count=0]\n``` even though the Splunk docs say something different, \"| fillnull\" does not seem to work with \"| stats latest\", so we do a workaround to display a zero if nothing was found ```\n| eval counter = if(isnull(cDIC), count, cDIC)\n| fields counter",
				"extend": "ds_nvhTyJfV"
			},
			"name": "get_DIC_disabled"
		},
		"ds_dubEkho7": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_nvhTyJfV",
				"query": "| where enableDataIntegrityControl=1 OR enableDataIntegrityControl LIKE \"true\"\n| stats latest(indexCount) AS cDIC\n| appendpipe [stats count | where count=0]\n``` even though the Splunk docs say something different, \"| fillnull\" does not seem to work with \"| stats latest\", so we do a workaround to display a zero if nothing was found ```\n| eval counter = if(isnull(cDIC), count, cDIC)\n| fields counter"
			},
			"name": "get_DIC_enabled"
		},
		"ds_ezIITtPe": {
			"type": "ds.search",
			"options": {
				"query": "index=\"app_eavc\" sourcetype=\"eavc:mc_hec*\"\n| table server, disabled, stanza, enableSSL, index, sourcetype, app_context, port, useACK, serverCert, sslVersions, requireClientCert, forceHttp10, sslCommonNameToCheck, allowSslRenegotiation\n| rename server AS Host, stanza as Stanza, app_context AS \"App Context\"",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_hec_data"
		},
		"ds_X29xpq8Y": {
			"type": "ds.search",
			"options": {
				"query": "index=app_eavc sourcetype=\"eavc:mc_indexer_tls\" server=\"$tok_host$\"\n| table server, tlsEnabled, stanza, app_context, allowSslRenegotiation,  requireClientCert, serverCert, sslCommonNameToCheck, sslVersions, useSSLCompression\n| rename server AS Host, stanza as Stanza, app_context AS \"App Context\", tlsEnabled AS \"TLS enabled\"",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_idx_tls"
		},
		"ds_nvhTyJfV": {
			"type": "ds.search",
			"options": {
				"query": "index=app_eavc sourcetype=\"eavc:mc_indexer_dic\" \n| fields *",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_DIC"
		},
		"ds_tiBNKmRV": {
			"type": "ds.search",
			"options": {
				"query": "index=\"app_eavc\" sourcetype=\"eavc:mc_indexer_tls\" tlsEnabled=true \n| fields server \n| stats c(server) AS counter",
				"queryParameters": {
					"earliest": "-14d@d",
					"latest": "now"
				}
			},
			"name": "get_idx_tls_count"
		},
		"ds_374YUX51": {
			"type": "ds.search",
			"options": {
				"query": "index=app_eavc sourcetype=\"eavc:mc_indexer_dic\" totalIndexCount=*\n| stats latest(totalIndexCount) AS total",
				"queryParameters": {
					"earliest": "-14d@d",
					"latest": "now"
				}
			},
			"name": "get_index_count"
		},
		"ds_gg3wvzRH": {
			"type": "ds.search",
			"options": {
				"query": "| rest /servicesNS/-/-/search/distributed/peers splunk_server=*\n|  fields - eai:acl.*\n|  eval server = if(isnull(host_fqdn), host, host_fqdn)\n| fields server, status, version, cluster_label, replicationStatus, cpu_arch, numberOf*, physicalMemoryMB, os_name, os_version",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "IDXC_status"
		},
		"ds_ZLTPHf3t": {
			"type": "ds.search",
			"options": {
				"query": "index=\"app_eavc\" sourcetype=\"eavc:mc_environment\" \n| fields server, server_roles \n| rex field=server_roles \"(?<peer>indexer)\" \n| rex field=server_roles \"(?<peer2>cluster_peer)\" \n| eval search_peer = if(isnull(peer2) OR peer2==\"\", peer, peer2) \n| eval is_peer = if(isnull(search_peer) OR search_peer==\"\", \"false\", \"true\") \n| fields - peer, peer2 \n| where is_peer==\"true\" \n| fields server \n| join type=left server \n    [| rest /services/configs/conf-web splunk_server=* \n    | search title=\"settings\" \n    | fields splunk_server title, startwebserver \n    | rename splunk_server AS server \n     ]\n|  where startwebserver=0\n|  stats c",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "count_webserver_disabled"
		}
	},
	"defaults": {
		"dataSources": {
			"ds.search": {
				"options": {
					"queryParameters": {
						"latest": "$global_time.latest$",
						"earliest": "$global_time.earliest$"
					}
				}
			}
		}
	},
	"inputs": {
		"input_global_trp": {
			"type": "input.timerange",
			"options": {
				"token": "tok_time",
				"defaultValue": "-7d@h,now"
			},
			"title": "Time Range"
		},
		"input_YT7297I0": {
			"options": {
				"defaultValue": "*",
				"token": "tok_host"
			},
			"title": "Filter Host",
			"type": "input.text"
		}
	},
	"layout": {
		"type": "grid",
		"options": {},
		"structure": [
			{
				"item": "viz_RT30G5tI",
				"type": "block",
				"position": {
					"x": 0,
					"y": 0,
					"w": 221,
					"h": 209
				}
			},
			{
				"item": "viz_Iu62dB0A",
				"type": "block",
				"position": {
					"x": 0,
					"y": 209,
					"w": 1200,
					"h": 476
				}
			},
			{
				"item": "viz_hzt2ByEj",
				"type": "block",
				"position": {
					"x": 0,
					"y": 685,
					"w": 1200,
					"h": 372
				}
			},
			{
				"item": "viz_1ESFgaWf",
				"type": "block",
				"position": {
					"x": 0,
					"y": 1057,
					"w": 1200,
					"h": 485
				}
			},
			{
				"item": "viz_qv1rS5t1",
				"type": "block",
				"position": {
					"x": 221,
					"y": 0,
					"w": 195,
					"h": 209
				}
			},
			{
				"item": "viz_ZvFciRgB",
				"type": "block",
				"position": {
					"x": 416,
					"y": 0,
					"w": 142,
					"h": 209
				}
			},
			{
				"item": "viz_iKQAtYaT",
				"type": "block",
				"position": {
					"x": 558,
					"y": 0,
					"w": 216,
					"h": 209
				}
			},
			{
				"item": "viz_pieH0lXZ",
				"type": "block",
				"position": {
					"x": 774,
					"y": 0,
					"w": 210,
					"h": 209
				}
			},
			{
				"item": "viz_GEuYdlpS",
				"type": "block",
				"position": {
					"x": 984,
					"y": 0,
					"w": 216,
					"h": 209
				}
			}
		],
		"globalInputs": [
			"input_global_trp",
			"input_YT7297I0"
		]
	},
	"description": "List several details of your indexer's encryption status",
	"title": "Indexer Status"
}
    ]]></definition>
    <meta type="hiddenElements"><![CDATA[
{
	"hideEdit": false,
	"hideOpenInSearch": false,
	"hideExport": true
}
    ]]></meta>
</dashboard>