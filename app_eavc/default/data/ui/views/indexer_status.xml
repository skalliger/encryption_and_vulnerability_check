
<dashboard version="2" theme="dark">
    <label>Indexer Status</label>
    <description>List several details of your indexer&#39;s encryption status</description>
    <definition><![CDATA[
{
	"visualizations": {
		"viz_RT30G5tI": {
			"type": "splunk.singlevalue",
			"showProgressBar": false,
			"showLastUpdated": false,
			"dataSources": {
				"primary": "ds_m4pXDoNf"
			},
			"title": "Number of Indexers"
		},
		"viz_qv1rS5t1": {
			"type": "splunk.singlevalue",
			"title": "Indexers with splunktcp-ssl enabled",
			"dataSources": {
				"primary": "ds_LRiEOvQ7"
			}
		},
		"viz_hzt2ByEj": {
			"type": "splunk.table",
			"title": "Encryption Details",
			"dataSources": {
				"primary": "ds_1Nmc7pFP"
			},
			"options": {
				"columnFormat": {
					"disabled": {
						"data": "> table | seriesByName(\"disabled\") | formatByType(disabledColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('disabled') | pick(disabledRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"disabled\") | matchValue(disabledRowBackgroundColorsEditorConfig)"
					},
					"sslVersions": {
						"data": "> table | seriesByName(\"sslVersions\") | formatByType(sslVersionsColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('sslVersions') | pick(sslVersionsRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"sslVersions\") | matchValue(sslVersionsRowBackgroundColorsEditorConfig)"
					}
				}
			},
			"context": {
				"disabledColumnFormatEditorConfig": {
					"number": {
						"thousandSeparated": false,
						"unitPosition": "after"
					}
				},
				"disabledRowColorsEditorConfig": [
					"#ffffff"
				],
				"disabledRowBackgroundColorsEditorConfig": [
					{
						"match": 0,
						"value": "#2f8811"
					},
					{
						"match": 1,
						"value": "#555555"
					},
					{
						"match": "false",
						"value": "#2f8811"
					},
					{
						"match": "true",
						"value": "#555555"
					}
				],
				"sslVersionsColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"sslVersionsRowColorsEditorConfig": [
					"#ffffff"
				],
				"sslVersionsRowBackgroundColorsEditorConfig": [
					{
						"match": "sslv2",
						"value": "#78062a"
					},
					{
						"match": "sslv3",
						"value": "#78062a"
					},
					{
						"match": "tls1.1",
						"value": "#AD3F20"
					},
					{
						"match": "tls1.2",
						"value": "#2f8811"
					}
				]
			}
		},
		"viz_iKQAtYaT": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_4ephixIX"
			},
			"title": "Indexes with enableDataIntegrityControl = false"
		},
		"viz_pieH0lXZ": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_dubEkho7"
			},
			"title": "Indexes with enableDataIntegrityControl = true"
		}
	},
	"dataSources": {
		"ds_m4pXDoNf": {
			"type": "ds.search",
			"options": {
				"query": "index=_internal component=\"Metrics\" instance_roles=*\n| fields - _raw\n| dedup server_name\n| regex instance_roles=\"(indexer)\"\n| stats count",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_all_idx"
		},
		"ds_fRw5HYyL": {
			"type": "ds.search",
			"options": {
				"query": "| rest /services/configs/conf-inputs splunk_server=*\n|  fields *",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "REST_inputs"
		},
		"ds_LRiEOvQ7": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_fRw5HYyL",
				"query": "| search title=\"splunktcp-ssl*\" eai:acl.app!=system disabled=0\n| stats count"
			},
			"name": "get_splunktcp-ssl_enabled"
		},
		"ds_1Nmc7pFP": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_fRw5HYyL",
				"query": "| search title=\"splunktcp*\" eai:acl.app!=system\n| table host, disabled, title, acceptFrom, allowSslRenegotiation, cipherSuite, eai:acl.app, ecdhCurves, requireClientCert, serverCert, sslCommonNameToCheck, sslVersions, useSSLCompression\n| rename host AS Instance, eai:acl.app AS \"App Context\", title AS Stanza\n| sort Instance"
			},
			"name": "get_encryption_details"
		},
		"ds_3W8Inj61": {
			"type": "ds.search",
			"options": {
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				},
				"query": "| rest /servicesNS/-/-/configs/conf-indexes\n| fields eai:*, enableDataIntegrityControl, title"
			},
			"name": "REST_indexes_conf"
		},
		"ds_4ephixIX": {
			"type": "ds.chain",
			"options": {
				"query": "| fields - eai:acl.can*\n| where enableDataIntegrityControl=0 OR enableDataIntegrityControl LIKE \"false\"\n| stats dc(title) AS \"cIndexes\"",
				"extend": "ds_3W8Inj61"
			},
			"name": "get_DIC_disabled"
		},
		"ds_dubEkho7": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_3W8Inj61",
				"query": "| fields - eai:acl.can*\n| where enableDataIntegrityControl=1 OR enableDataIntegrityControl LIKE \"true\"\n| stats dc(title) AS \"cIndexes\""
			},
			"name": "get_DIC_enabled"
		}
	},
	"defaults": {
		"dataSources": {
			"ds.search": {
				"options": {
					"queryParameters": {
						"latest": "$global_time.latest$",
						"earliest": "$global_time.earliest$"
					}
				}
			}
		}
	},
	"inputs": {
		"input_global_trp": {
			"type": "input.timerange",
			"options": {
				"token": "tok_time",
				"defaultValue": "-60m@m,now"
			},
			"title": "Time Range"
		}
	},
	"layout": {
		"type": "grid",
		"options": {},
		"structure": [
			{
				"item": "viz_RT30G5tI",
				"type": "block",
				"position": {
					"x": 0,
					"y": 0,
					"w": 195,
					"h": 267
				}
			},
			{
				"item": "viz_hzt2ByEj",
				"type": "block",
				"position": {
					"x": 0,
					"y": 267,
					"w": 1200,
					"h": 1333
				}
			},
			{
				"item": "viz_qv1rS5t1",
				"type": "block",
				"position": {
					"x": 195,
					"y": 0,
					"w": 261,
					"h": 267
				}
			},
			{
				"item": "viz_iKQAtYaT",
				"type": "block",
				"position": {
					"x": 456,
					"y": 0,
					"w": 367,
					"h": 267
				}
			},
			{
				"item": "viz_pieH0lXZ",
				"type": "block",
				"position": {
					"x": 823,
					"y": 0,
					"w": 377,
					"h": 267
				}
			}
		],
		"globalInputs": [
			"input_global_trp"
		]
	},
	"description": "List several details of your indexer's encryption status",
	"title": "Indexer Status"
}
    ]]></definition>
    <meta type="hiddenElements"><![CDATA[
{
	"hideEdit": false,
	"hideOpenInSearch": false,
	"hideExport": true
}
    ]]></meta>
</dashboard>