
<dashboard version="2" theme="dark">
    <label>Hardening Report</label>
    <description>You do not have to pass all checks. Many of them are for hardened environments and require the strictest settings.</description>
    <definition><![CDATA[
{
	"visualizations": {
		"viz_0K0rTXva": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_uKGYLQ4n"
			},
			"title": "Total mitigated SVDs"
		},
		"viz_zjg7t9F4": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_6QEM0bEP"
			},
			"title": "Amount of Splunk Vulnerability Disclosures",
			"eventHandlers": [
				{
					"type": "drilldown.linkToDashboard",
					"options": {
						"app": "app_eavc",
						"dashboard": "splunk_security_advisories"
					}
				}
			]
		},
		"viz_zZ81wI99": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_r3Z7SVkG"
			},
			"title": "Still affected by # of SVDs",
			"description": "",
			"options": {
				"unit": "",
				"trendDisplay": "off"
			},
			"eventHandlers": [
				{
					"type": "drilldown.linkToDashboard",
					"options": {
						"app": "app_eavc",
						"dashboard": "unresolved",
						"newTab": true
					}
				}
			]
		},
		"viz_ZclBZhq7": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_PjNn3hAi"
			},
			"title": "Manual Checks required",
			"eventHandlers": [
				{
					"type": "drilldown.linkToDashboard",
					"options": {
						"app": "app_eavc",
						"dashboard": "manual_checks",
						"newTab": true
					}
				}
			]
		},
		"viz_ahHiaDcy": {
			"type": "splunk.table",
			"dataSources": {
				"primary": "ds_GZAvNlGm"
			},
			"title": "Validations",
			"options": {
				"columnFormat": {
					"Check": {
						"data": "> table | seriesByName(\"Check\") | formatByType(CheckColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('Check') | pick(CheckRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"Check\") | matchValue(CheckRowBackgroundColorsEditorConfig)"
					},
					"Validation": {
						"data": "> table | seriesByName(\"Validation\") | formatByType(ValidationColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('Validation') | pick(ValidationRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"Validation\") | matchValue(ValidationRowBackgroundColorsEditorConfig)"
					},
					"Check Identifier": {
						"width": 30
					},
					"Check Description": {
						"width": 55
					}
				},
				"count": 30,
				"fontSize": "large"
			},
			"context": {
				"CheckColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"CheckRowColorsEditorConfig": [
					"#ffffff"
				],
				"CheckRowBackgroundColorsEditorConfig": [
					{
						"match": "fail",
						"value": "#78062a"
					},
					{
						"match": "pass",
						"value": "#2f8811"
					}
				],
				"ValidationColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"ValidationRowColorsEditorConfig": [
					"#ffffff"
				],
				"ValidationRowBackgroundColorsEditorConfig": [
					{
						"match": "fail",
						"value": "#78062a"
					},
					{
						"match": "pass",
						"value": "#2f8811"
					},
					{
						"match": "N.A. (single instance)",
						"value": "#555555"
					}
				]
			},
			"description": "Some checks only appear when they are applicable (like ES or ITSI).",
			"eventHandlers": []
		},
		"viz_aCbkUAEG": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_D7KzuBEO"
			},
			"title": "Failed Validation Checks"
		}
	},
	"dataSources": {
		"ds_6QEM0bEP": {
			"type": "ds.search",
			"options": {
				"query": "| inputlookup svd_mitigation\n| fields svd_id\n| stats count",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "svd_00"
		},
		"ds_p2WvDdCK": {
			"type": "ds.search",
			"options": {
				"query": "| inputlookup svd_mitigation_status\n| fields *",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "all_mitigations"
		},
		"ds_uKGYLQ4n": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_p2WvDdCK",
				"query": "| where Status LIKE \"mitigated\"\n| stats count"
			},
			"name": "svd_01"
		},
		"ds_r3Z7SVkG": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_p2WvDdCK",
				"query": "| where Status LIKE \"vulnerable\"\n| stats count"
			},
			"name": "svd_02"
		},
		"ds_PjNn3hAi": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_p2WvDdCK",
				"query": "| where Status LIKE \"manual check\" \n| stats count\n\n\n```\nINFO:\n\nTo set these checks to \"done\", you have to edit the \"svd_manual_checks\" lookup file (shipped with this app).\n\nThe saved search (found under Reports) \"populate_manual_checks_lookup\" is not run by default, so this list may be empty. You can run this once to get your manual checks that need to be done.\n\nYou can easily edit lookup files with the \"Splunk App for Lookup File Editing\" (https://splunkbase.splunk.com/app/1724)\n\n```"
			},
			"name": "svd_03"
		},
		"ds_GZAvNlGm": {
			"type": "ds.search",
			"options": {
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				},
				"query": "| inputlookup svd_hardening_report\n|  table name, description, validation\n|  rename name AS \"Check Identifier\", description AS Description, validation AS Validation\n"
			},
			"name": "svd_combined_report"
		},
		"ds_yOOXDfk6": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_r3Z7SVkG",
				"query": "| eval check = if(count=0, \"pass\", \"fail\")\n| eval name = \"svd_02_MR\"\n|  fields name, check"
			},
			"name": "svd_02_MR-report"
		},
		"ds_D7KzuBEO": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_GZAvNlGm",
				"query": "| where Validation LIKE \"fail\"\n|  stats count"
			},
			"name": "count_failed_checks"
		}
	},
	"defaults": {
		"dataSources": {
			"ds.search": {
				"options": {
					"queryParameters": {
						"latest": "$global_time.latest$",
						"earliest": "$global_time.earliest$"
					}
				}
			}
		}
	},
	"inputs": {
		"input_global_trp": {
			"type": "input.timerange",
			"options": {
				"token": "tok_time",
				"defaultValue": "-7d@h,now"
			},
			"title": "Global Time Range"
		}
	},
	"layout": {
		"type": "grid",
		"options": {
			"width": 1440,
			"height": 960
		},
		"structure": [
			{
				"item": "viz_zjg7t9F4",
				"type": "block",
				"position": {
					"x": 0,
					"y": 0,
					"w": 300,
					"h": 209
				}
			},
			{
				"item": "viz_ahHiaDcy",
				"type": "block",
				"position": {
					"x": 0,
					"y": 209,
					"w": 1440,
					"h": 982
				}
			},
			{
				"item": "viz_0K0rTXva",
				"type": "block",
				"position": {
					"x": 300,
					"y": 0,
					"w": 297,
					"h": 209
				}
			},
			{
				"item": "viz_zZ81wI99",
				"type": "block",
				"position": {
					"x": 597,
					"y": 0,
					"w": 292,
					"h": 209
				}
			},
			{
				"item": "viz_ZclBZhq7",
				"type": "block",
				"position": {
					"x": 889,
					"y": 0,
					"w": 270,
					"h": 209
				}
			},
			{
				"item": "viz_aCbkUAEG",
				"type": "block",
				"position": {
					"x": 1159,
					"y": 0,
					"w": 281,
					"h": 209
				}
			}
		],
		"globalInputs": [
			"input_global_trp"
		]
	},
	"description": "You do not have to pass all checks. Many of them are for hardened environments and require the strictest settings.",
	"title": "Hardening Report"
}
    ]]></definition>
    <meta type="hiddenElements"><![CDATA[
{
	"hideEdit": false,
	"hideOpenInSearch": false,
	"hideExport": false
}
    ]]></meta>
</dashboard>
