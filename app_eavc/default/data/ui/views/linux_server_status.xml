
<dashboard version="2" theme="dark">
    <label>Linux Server Status</label>
    <description>more will be added later on. Splunk officially only supports kernel 5.x https://docs.splunk.com/Documentation/Splunk/latest/Installation/Systemrequirements</description>
    <definition><![CDATA[
{
	"visualizations": {
		"viz_Y8Wf3O4A": {
			"type": "splunk.table",
			"dataSources": {
				"primary": "ds_NJIGAp6t"
			},
			"title": "Linux Kernel Versions",
			"options": {
				"columnFormat": {
					"Currently supported": {
						"data": "> table | seriesByName(\"Currently supported\") | formatByType(Currently_supportedColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('Currently supported') | pick(Currently_supportedRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"Currently supported\") | matchValue(Currently_supportedRowBackgroundColorsEditorConfig)"
					},
					"Host": {
						"width": 71
					},
					"Kernel Version": {
						"width": 64
					},
					"End of Life": {
						"width": 55
					},
					"Long Term Support": {
						"width": 74,
						"data": "> table | seriesByName(\"Long Term Support\") | formatByType(Long_Term_SupportColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName(\"Long Term Support\") | matchValue(Long_Term_SupportRowColorsEditorConfig)"
					}
				}
			},
			"context": {
				"Currently_supportedColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"Currently_supportedRowColorsEditorConfig": [
					"#ffffff"
				],
				"Currently_supportedRowBackgroundColorsEditorConfig": [
					{
						"match": "no",
						"value": "#78062a"
					},
					{
						"match": "yes",
						"value": "#2f8811"
					}
				],
				"Long_Term_SupportColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"Long_Term_SupportRowColorsEditorConfig": [
					{
						"match": "false",
						"value": "#555555"
					},
					{
						"match": "true",
						"value": "#207865"
					}
				]
			},
			"eventHandlers": []
		},
		"viz_WDh8dvA3": {
			"type": "splunk.table",
			"dataSources": {
				"primary": "ds_Fzm2VecV"
			},
			"title": "All Kernel Versions",
			"options": {
				"columnFormat": {
					"Currently supported": {
						"data": "> table | seriesByName(\"Currently supported\") | formatByType(Currently_supportedColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('Currently supported') | pick(Currently_supportedRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"Currently supported\") | matchValue(Currently_supportedRowBackgroundColorsEditorConfig)"
					},
					"lts": {
						"data": "> table | seriesByName(\"lts\") | formatByType(ltsColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('lts') | matchValue(ltsRowColorsEditorConfig)"
					}
				},
				"count": 15
			},
			"context": {
				"Currently_supportedColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"Currently_supportedRowColorsEditorConfig": [
					"#ffffff"
				],
				"Currently_supportedRowBackgroundColorsEditorConfig": [
					{
						"match": "no",
						"value": "#78062a"
					},
					{
						"match": "yes",
						"value": "#2f8811"
					}
				],
				"ltsColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"ltsRowColorsEditorConfig": [
					{
						"match": "false",
						"value": "#555555"
					},
					{
						"match": "true",
						"value": "#207865"
					}
				]
			}
		},
		"viz_OZJXsSqP": {
			"type": "splunk.table",
			"dataSources": {
				"primary": "ds_cGncMCmj"
			},
			"title": "File System Permissions",
			"options": {
				"columnFormat": {
					"owner": {
						"data": "> table | seriesByName(\"owner\") | formatByType(ownerColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('owner') | pick(ownerRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"owner\") | matchValue(ownerRowBackgroundColorsEditorConfig)"
					},
					"group": {
						"data": "> table | seriesByName(\"group\") | formatByType(groupColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('group') | pick(groupRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"group\") | matchValue(groupRowBackgroundColorsEditorConfig)"
					},
					"otherPerm": {
						"data": "> table | seriesByName(\"otherPerm\") | formatByType(otherPermColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('otherPerm') | pick(otherPermRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"otherPerm\") | matchValue(otherPermRowBackgroundColorsEditorConfig)"
					},
					"userPerm": {
						"data": "> table | seriesByName(\"userPerm\") | formatByType(userPermColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('userPerm') | pick(userPermRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"userPerm\") | matchValue(userPermRowBackgroundColorsEditorConfig)"
					},
					"groupPerm": {
						"data": "> table | seriesByName(\"groupPerm\") | formatByType(groupPermColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('groupPerm') | pick(groupPermRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"groupPerm\") | matchValue(groupPermRowBackgroundColorsEditorConfig)"
					}
				}
			},
			"context": {
				"ownerColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"ownerRowColorsEditorConfig": [
					"#ffffff"
				],
				"ownerRowBackgroundColorsEditorConfig": [
					{
						"match": "root",
						"value": "#78062a"
					}
				],
				"groupColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"groupRowColorsEditorConfig": [
					"#ffffff"
				],
				"groupRowBackgroundColorsEditorConfig": [
					{
						"match": "root",
						"value": "#78062a"
					}
				],
				"otherPermColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"otherPermRowColorsEditorConfig": [
					"#ffffff"
				],
				"otherPermRowBackgroundColorsEditorConfig": [
					{
						"match": "rwx",
						"value": "#78062a"
					},
					{
						"match": "r-x",
						"value": "#ad3f20"
					},
					{
						"match": "---",
						"value": "#2f8811"
					}
				],
				"userPermColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"userPermRowColorsEditorConfig": [
					"#ffffff"
				],
				"userPermRowBackgroundColorsEditorConfig": [
					{
						"match": "rwx",
						"value": "#2f8811"
					},
					{
						"match": "r-x",
						"value": "#78062a"
					}
				],
				"groupPermColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"groupPermRowColorsEditorConfig": [
					"#ffffff"
				],
				"groupPermRowBackgroundColorsEditorConfig": [
					{
						"match": "r-x",
						"value": "#2f8811"
					},
					{
						"match": "rwx",
						"value": "#2f8811"
					},
					{
						"match": "---",
						"value": "#555555"
					}
				]
			}
		},
		"viz_5jC3Zphf": {
			"type": "splunk.table",
			"options": {
				"columnFormat": {
					"SELinux Status": {
						"data": "> table | seriesByName(\"SELinux Status\") | formatByType(SELinux_StatusColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('SELinux Status') | pick(SELinux_StatusRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"SELinux Status\") | matchValue(SELinux_StatusRowBackgroundColorsEditorConfig)"
					}
				}
			},
			"dataSources": {
				"primary": "ds_Hm35qBGg"
			},
			"context": {
				"SELinux_StatusColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"SELinux_StatusRowColorsEditorConfig": [
					"#ffffff"
				],
				"SELinux_StatusRowBackgroundColorsEditorConfig": [
					{
						"match": "disabled",
						"value": "#ad3f20"
					},
					{
						"match": "enabled",
						"value": "#2f8811"
					}
				]
			},
			"title": "Security Enhanced Linux Status",
			"description": "If empty, the \"sestatus\" command was most likely not found."
		}
	},
	"dataSources": {
		"ds_NJIGAp6t": {
			"type": "ds.search",
			"options": {
				"query": "index=app_eavc sourcetype=\"eavc:kernel_check\" host=\"$tok_host$\" | fields kernel_version, host\n| join type=left [ | search index=app_eavc sourcetype=\"eavc:kernel_versions\"\n| fields kernel_version, eol, lts ]\n| eval currDate = strftime(now(), \"%Y-%m-%d\") \n| eval currentEpoch = strptime(currDate, \"%Y-%m-%d\") \n| eval futureEpoch = strptime(eol, \"%Y-%m-%d\") \n| eval is_supported = if(currentEpoch <= futureEpoch, \"yes\", \"no\") \n| stats latest(kernel_version) AS kernel_version by host, eol, lts, is_supported\n| table host, kernel_version, eol, lts, is_supported\n| rename kernel_version AS \"Kernel Version\", host AS Host, eol AS \"End of Life\", lts AS \"Long Term Support\", is_supported AS \"Currently supported\"",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_current_kernel_version"
		},
		"ds_Fzm2VecV": {
			"type": "ds.search",
			"options": {
				"query": "| inputlookup linux_kernel_versions \n| sort - releaseDate \n| eval currDate = strftime(now(), \"%Y-%m-%d\") \n| eval currentEpoch = strptime(currDate, \"%Y-%m-%d\") \n| eval futureEpoch = strptime(eol, \"%Y-%m-%d\") \n| eval is_supported = if(currentEpoch <= futureEpoch, \"yes\", \"no\") \n| table kernel_version, releaseDate, eol, lts, is_supported, latest, latestReleaseDate \n| search is_supported=\"$tok_sup$\" AND latest=\"$tok_release$\" AND lts=\"$tok_lts$\" \n| rename kernel_versions AS \"Kernel Version\", releaseDate AS \"Release Date\", eol AS \"End of Life\", is_supported AS \"Currently supported\", latest as \"Latest Release\"",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_all_kernels_versions"
		},
		"ds_cGncMCmj": {
			"type": "ds.search",
			"options": {
				"query": "index=app_eavc sourcetype=\"eavc:permission_check\" host=\"$tok_host$\"\n| eval parent = \"/\"\n| eval SPLUNK_HOME = mvzip(parent, splunk_home, \"\")\n| stats latest(owner) AS owner, latest(group) AS group, latest(u_permissions) AS userPerm latest(g_permissions) AS groupPerm, latest(o_permissions) AS otherPerm, values(SPLUNK_HOME) AS \"Splunk Home\" by host\n|  table host, \"Splunk Home\", owner, group, userPerm, groupPerm, otherPerm\n|  rename host AS Host",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_fs_permissions"
		},
		"ds_Hm35qBGg": {
			"type": "ds.search",
			"options": {
				"query": "index=app_eavc sourcetype=eavc:selinux host=\"$tok_host$\"\n| stats latest(sestatus) as SEStatus by host\n|  rename SEStatus AS \"SELinux Status\", host AS Host",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_selinux_status"
		}
	},
	"defaults": {
		"dataSources": {
			"ds.search": {
				"options": {
					"queryParameters": {
						"latest": "$global_time.latest$",
						"earliest": "$global_time.earliest$"
					}
				}
			}
		}
	},
	"inputs": {
		"input_global_trp": {
			"type": "input.timerange",
			"options": {
				"token": "tok_time",
				"defaultValue": "-7d@h,now"
			},
			"title": "Global Time Range"
		},
		"input_780hOp7l": {
			"options": {
				"items": [
					{
						"label": "All",
						"value": "*"
					},
					{
						"label": "Yes",
						"value": "yes"
					},
					{
						"label": "No",
						"value": "no"
					}
				],
				"defaultValue": "*",
				"token": "tok_sup"
			},
			"title": "Supported versions only",
			"type": "input.dropdown"
		},
		"input_sObUlfcH": {
			"options": {
				"defaultValue": "*",
				"token": "tok_release"
			},
			"title": "Search kernel release",
			"type": "input.text"
		},
		"input_j64wG7x7": {
			"options": {
				"items": [
					{
						"label": "All",
						"value": "*"
					},
					{
						"label": "Yes",
						"value": "true"
					},
					{
						"label": "No",
						"value": "false"
					}
				],
				"defaultValue": "*",
				"token": "tok_lts"
			},
			"title": "LTS kernels only",
			"type": "input.dropdown"
		},
		"input_jP2bp3nZ": {
			"options": {
				"defaultValue": "*",
				"token": "tok_host"
			},
			"title": "Filter Host",
			"type": "input.text"
		}
	},
	"layout": {
		"type": "grid",
		"options": {
			"width": 1440,
			"height": 960
		},
		"structure": [
			{
				"item": "viz_Y8Wf3O4A",
				"type": "block",
				"position": {
					"x": 0,
					"y": 0,
					"w": 530,
					"h": 616
				}
			},
			{
				"item": "viz_OZJXsSqP",
				"type": "block",
				"position": {
					"x": 0,
					"y": 616,
					"w": 720,
					"h": 377
				}
			},
			{
				"item": "viz_WDh8dvA3",
				"type": "block",
				"position": {
					"x": 530,
					"y": 0,
					"w": 910,
					"h": 616
				}
			},
			{
				"item": "viz_5jC3Zphf",
				"type": "block",
				"position": {
					"x": 720,
					"y": 616,
					"w": 720,
					"h": 377
				}
			}
		],
		"globalInputs": [
			"input_global_trp",
			"input_780hOp7l",
			"input_j64wG7x7",
			"input_sObUlfcH",
			"input_jP2bp3nZ"
		]
	},
	"description": "more will be added later on. Splunk officially only supports kernel 5.x https://docs.splunk.com/Documentation/Splunk/latest/Installation/Systemrequirements",
	"title": "Linux Server Status"
}
    ]]></definition>
    <meta type="hiddenElements"><![CDATA[
{
	"hideEdit": false,
	"hideOpenInSearch": false,
	"hideExport": false
}
    ]]></meta>
</dashboard>