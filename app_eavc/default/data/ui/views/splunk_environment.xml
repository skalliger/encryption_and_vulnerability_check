
<dashboard version="2" theme="dark">
    <label>Splunk Environment</label>
    <description>This dashboard is kind of new and the base app stuff may get removed later on. I thought it might be useful to have.</description>
    <definition><![CDATA[
{
	"visualizations": {
		"viz_RRBPP7RK": {
			"type": "splunk.table",
			"options": {
				"columnFormat": {
					"licenseState": {
						"data": "> table | seriesByName(\"licenseState\") | formatByType(licenseStateColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName(\"licenseState\") | matchValue(licenseStateRowColorsEditorConfig)",
						"width": 100
					},
					"kvStoreStatus": {
						"data": "> table | seriesByName(\"kvStoreStatus\") | formatByType(kvStoreStatusColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName(\"kvStoreStatus\") | matchValue(kvStoreStatusRowColorsEditorConfig)",
						"width": 112
					},
					"physicalMemoryMB": {
						"width": 141
					},
					"numberOfVirtualCores": {
						"width": 162
					},
					"numberOfCores": {
						"width": 125
					},
					"manager_uri": {
						"width": 113
					},
					"federated_search_enabled": {
						"width": 194
					},
					"os_version": {
						"width": 102
					},
					"Server Roles": {
						"width": 121
					},
					"FIPS Mode": {
						"width": 97
					}
				}
			},
			"dataSources": {
				"primary": "ds_SlcawRvH"
			},
			"context": {
				"licenseStateColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"licenseStateRowColorsEditorConfig": [
					{
						"match": "OK",
						"value": "#2f8811"
					},
					{
						"match": "expired",
						"value": "#207865"
					},
					{
						"match": "invalid",
						"value": "#78062a"
					}
				],
				"kvStoreStatusColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"kvStoreStatusRowColorsEditorConfig": [
					{
						"match": "ready",
						"value": "#2f8811"
					},
					{
						"match": "failed",
						"value": "#78062a"
					}
				]
			}
		},
		"viz_L2OA4z3m": {
			"type": "splunk.singlevalue",
			"title": "Number of Splunk Enterprise Instances",
			"dataSources": {
				"primary": "ds_uwOds2aO"
			}
		},
		"viz_XX0Y5HHM": {
			"type": "splunk.singlevalue",
			"options": {
				"sparklineDisplay": "off",
				"trendDisplay": "off"
			},
			"dataSources": {
				"primary": "ds_4MykLGtz"
			},
			"title": "Base Apps"
		},
		"viz_ci9Pw4br": {
			"type": "splunk.table",
			"dataSources": {
				"primary": "ds_Ul2VypqN"
			},
			"title": "Base Apps",
			"description": "found on all instances",
			"options": {
				"showInternalFields": false,
				"headerVisibility": "none",
				"count": 15
			}
		},
		"viz_DFqDarwT": {
			"type": "splunk.table",
			"options": {
				"showInternalFields": false,
				"columnFormat": {
					"App": {
						"width": 74
					},
					"Version": {
						"width": 60
					}
				},
				"count": 15
			},
			"dataSources": {
				"primary": "ds_QSYnvZUs"
			},
			"title": "Apps across all Instances",
			"description": "excluding base apps"
		},
		"viz_RGaKuvJc": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_92JlShSt"
			},
			"title": "Number of Apps"
		},
		"viz_37zSpFyM": {
			"type": "splunk.table",
			"dataSources": {
				"primary": "ds_rBA218SH"
			},
			"title": "Splunk Certificate data",
			"description": "gets pulled from _internal, depends on when the last restarts were",
			"options": {
				"columnFormat": {
					"Still valid": {
						"data": "> table | seriesByName(\"Still valid\") | formatByType(Still_validColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName(\"Still valid\") | matchValue(Still_validRowColorsEditorConfig)"
					}
				}
			},
			"context": {
				"Still_validColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"Still_validRowColorsEditorConfig": [
					{
						"match": "no",
						"value": "#78062a"
					},
					{
						"match": "yes",
						"value": "#2f8811"
					}
				]
			}
		},
		"viz_qELzMt97": {
			"type": "splunk.singlevalue",
			"dataSources": {
				"primary": "ds_SB5wfIZF"
			},
			"title": "Splunk Validated Architectures Mapping",
			"eventHandlers": [
				{
					"type": "drilldown.customUrl",
					"options": {
						"url": "https://www.splunk.com/en_us/pdfs/white-paper/splunk-validated-architectures.pdf",
						"newTab": true
					}
				}
			]
		}
	},
	"dataSources": {
		"ds_SlcawRvH": {
			"type": "ds.search",
			"options": {
				"query": "index=\"app_eavc\" sourcetype=\"eavc:mc_environment\"\n| fields server, version, guid, server_roles, os_name, os_version, cpu_arch, federated_search_enabled, fips_mode, manager_uri, numberOfVirtualCores, numberOfCores, physicalMemoryMB, licenseState, kvStoreStatus, isForwarding, health_info, cluster_label\n| table server, version, guid, server_roles, os_name, os_version, cpu_arch, federated_search_enabled, fips_mode, manager_uri, numberOfVirtualCores, numberOfCores, physicalMemoryMB, licenseState, kvStoreStatus, isForwarding, health_info, cluster_label\n| search server=\"$tok_host$\"\n| sort server\n| rename server AS Host, version AS Version, guid AS GUID, server_roles AS \"Server Roles\", os_name AS \"OS\", fips_mode AS \"FIPS Mode\", cluster_label AS \"Cluster Label\"",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_splunk_env"
		},
		"ds_uwOds2aO": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_SlcawRvH",
				"query": "| fields Host\n| stats c"
			},
			"name": "count_instances"
		},
		"ds_iv6QhwCG": {
			"type": "ds.search",
			"options": {
				"query": "index=\"app_eavc\" sourcetype=\"eavc:mc_apps\" NOT title IN (\"DA-ESS*\", \"DA-ITSI*\", \"Splunk_*\", \"search\", \"splunk-*\", \"itsi\", \"SA-*\")\n| fields title\n| stats values(title) AS apps\n| mvexpand apps\n| where match(apps, \"(^[a-z]{2,5})_([a-zA-Z0-9]{2,10})_([a-zA-Z_0-9]{2,30})\")",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_base_apps"
		},
		"ds_Ul2VypqN": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_iv6QhwCG",
				"query": "| search apps=\"$tok_app$\" \n| table apps"
			},
			"name": "display_base_apps"
		},
		"ds_QSYnvZUs": {
			"type": "ds.search",
			"options": {
				"query": "index=\"app_eavc\" sourcetype=\"eavc:mc_apps\" \n| fields title, version, label \n| stats values(title) AS apps by version, label\n| mvexpand apps \n| where NOT match(apps, \"(^[a-z]{2,5})_([a-zA-Z0-9]{2,10})_([a-zA-Z_0-9]{2,30})\") \n| table apps, version, label\n| search apps=\"$tok_app$\" \n| sort + apps \n| rename apps AS App, version AS Version, label AS Label",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_all_apps"
		},
		"ds_92JlShSt": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_QSYnvZUs",
				"query": "| stats c"
			},
			"name": "count_all_apps"
		},
		"ds_rBA218SH": {
			"type": "ds.search",
			"options": {
				"query": "index=_internal CertificateData component=CertificateData \n| stats latest(ip), AS ipAddress, latest(nodeType) AS node, latest(subject) AS Subject, latest(subjectAltName) AS SAN, latest(issuer) AS CA, latest(notValidBefore) AS beginEpoch, latest(notValidAfter) AS endEpoch, by CN, channel\n| eval begin = strftime(beginEpoch, \"%Y-%m-%d\") \n| eval end = strftime(endEpoch, \"%Y-%m-%d\")\n| eval currDate = strftime(now(), \"%Y-%m-%d\") \n| eval currentEpoch = strptime(currDate, \"%Y-%m-%d\") \n| eval is_valid = if(currentEpoch <= endEpoch, \"yes\", \"no\") \n| fields CN, channel, ipAddress, node, Subject, SAN, CA, begin, end, is_valid\n| rename CN as \"Common Name\", channel AS Channel, CA AS issuer, begin AS \"Not valid before\", end AS \"Not valid after\", is_valid AS \"Still valid\"",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_cert_data"
		},
		"ds_4MykLGtz": {
			"type": "ds.chain",
			"options": {
				"query": "|  stats c",
				"extend": "ds_Ul2VypqN"
			},
			"name": "count_base_apps"
		},
		"ds_SB5wfIZF": {
			"type": "ds.search",
			"options": {
				"query": "| inputlookup sva\n| fields sva",
				"queryParameters": {
					"earliest": "$tok_time.earliest$",
					"latest": "$tok_time.latest$"
				}
			},
			"name": "get_sva"
		}
	},
	"defaults": {
		"dataSources": {
			"ds.search": {
				"options": {
					"queryParameters": {
						"latest": "$global_time.latest$",
						"earliest": "$global_time.earliest$"
					}
				}
			}
		}
	},
	"inputs": {
		"input_global_trp": {
			"type": "input.timerange",
			"options": {
				"token": "tok_time",
				"defaultValue": "-7d@h,now"
			},
			"title": "Global Time Range"
		},
		"input_AUthPvcg": {
			"options": {
				"defaultValue": "*",
				"token": "tok_host"
			},
			"title": "Filter Host",
			"type": "input.text"
		},
		"input_i0cbOZDq": {
			"options": {
				"defaultValue": "*",
				"token": "tok_app"
			},
			"title": "Search for App",
			"type": "input.text"
		}
	},
	"layout": {
		"type": "grid",
		"options": {
			"width": 1440,
			"height": 960
		},
		"structure": [
			{
				"item": "viz_qELzMt97",
				"type": "block",
				"position": {
					"x": 0,
					"y": 0,
					"w": 340,
					"h": 148
				}
			},
			{
				"item": "viz_RRBPP7RK",
				"type": "block",
				"position": {
					"x": 0,
					"y": 148,
					"w": 1440,
					"h": 566
				}
			},
			{
				"item": "viz_ci9Pw4br",
				"type": "block",
				"position": {
					"x": 0,
					"y": 714,
					"w": 542,
					"h": 659
				}
			},
			{
				"item": "viz_37zSpFyM",
				"type": "block",
				"position": {
					"x": 0,
					"y": 1373,
					"w": 1440,
					"h": 469
				}
			},
			{
				"item": "viz_L2OA4z3m",
				"type": "block",
				"position": {
					"x": 340,
					"y": 0,
					"w": 325,
					"h": 148
				}
			},
			{
				"item": "viz_DFqDarwT",
				"type": "block",
				"position": {
					"x": 542,
					"y": 714,
					"w": 898,
					"h": 659
				}
			},
			{
				"item": "viz_RGaKuvJc",
				"type": "block",
				"position": {
					"x": 665,
					"y": 0,
					"w": 404,
					"h": 148
				}
			},
			{
				"item": "viz_XX0Y5HHM",
				"type": "block",
				"position": {
					"x": 1069,
					"y": 0,
					"w": 371,
					"h": 148
				}
			}
		],
		"globalInputs": [
			"input_global_trp",
			"input_AUthPvcg",
			"input_i0cbOZDq"
		]
	},
	"description": "This dashboard is kind of new and the base app stuff may get removed later on. I thought it might be useful to have.",
	"title": "Splunk Environment"
}
    ]]></definition>
    <meta type="hiddenElements"><![CDATA[
{
	"hideEdit": false,
	"hideOpenInSearch": false,
	"hideExport": false
}
    ]]></meta>
</dashboard>