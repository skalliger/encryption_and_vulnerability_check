#!/usr/bin/env bash
set -euo pipefail
IFS=$'\n\t'

# this script checks for PYTHONHTTPSVERIFY in your splunk-launch.conf, as this is not logged when enabled
# we also don't want to search _internal logs because we don't know for certain when the last startup was (gives warnings when disabled)
appPath="${SPLUNK_HOME}/etc/apps/encryption_and_vulnerability_check"
csvFile="pythonhttps_status.csv"

echo "parameter,status" > $appPath/lookups/$csvFile
cat $SPLUNK_HOME/etc/splunk-launch.conf | grep PYTHONHTTPSVERIFY | tr = , | tr -d " " >> $appPath/lookups/$csvFile

