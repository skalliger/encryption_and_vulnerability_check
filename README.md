# encryption_and_vulnerability_check

This Splunk app checks for Splunk Vulnerability Disclosures and gives you an overview of your environment's encryption status.


## How to install


Download all apps.
Place the apps on your servers the following way:
| Name | Deployed on | Description |
| --- | --- | --- |
| app_eavc |One Search Head of your choice | This app contains most of the searches, all dashboards and all of the lookups |
| SA-mc_eavc | On your Monitoring Console | This Supporting Add-on contains a couple of REST searches that only can be ran on the MC to provide complete results. These are written to the app's index (app_eavc). |
| TA_eavc | On all Splunk Enterprise instances | contains a few scripts that will do checks for all instances |
| TA-indexer_eavc | Cluster Manager/manager-apps or on an Indexer if not clustered | With app version 3, an index was added to manage different use cases in bigger distributed environments. The volume of data in that index is pretty low, many searches populating the index only run once every 12 hours. |


## Getting started after installation


After all apps were installed, you will not see results immediately. Some reports may be delayed, a few are disabled because they usually only need to run once. All steps except the last step 8 are optional, as they will run after some time.

1. Run the reports on your Monitoring Console first if they're not run by default. There are three reports starting with "SA-mc_eavc_*"
2. Go to your Search Head, select the Encryption and Vulnerability Check App
3. Select Additional Links > Reports
4. Run "query_splunk_version"
5. Run "populate_uf_versions"
6. Run "populate_svd_upgrade_checks"
7. Run "populate_svd_uf_upgrade_checks" and "populate_svd_app_upgrade_checks"
8. Run "populate_manual_checks_lookup" once. This one is disabled and only needs to be run once. Afterwards, that lookup has to be manually edited because not all checks can be done automatically.

- The app contains a script which connects to this repository. It checks for new Splunk Vulnerability Disclosures (SVDs) inside the lookup and if found, will replace its old CSV file. That way you don't have to upgrade the whole app everytime new vulnerabilities have been made public.
- There are also other scripts, e.g. a script pulling an official list of supported Linux kernels. That information is included in the app as a lookup as well, so it's not required to allow that connection.
-  I'd recommend to allow the SH to connect to https.//*.github.com.


## Version 3

**Version 3** was a complete refactoring of the existing app. The most important changes are that the app that used to exist now is divided into an app, a Supporting Add-on and two Technical Add-ons.
Next to the refactoring for bigger environments, many new reports, dashboards, lookups and use cases were implemented.


## Version 2

**Version 2** has its dashboards migrated to the Dashboard Framework with some changes and additions.
Due to limits of the Dashboard Framework's features, drilldowns with tokens are limited, unfortunately.


Biggest changes are the implemented checks for the Splunk Vulnerability Disclosures. These lookups can be updated with the script found under bin (enabled by default). The script runs every 30 minutes and checks for changes on github.

The app contains a few scheduled searches. If you update the lookups OR use the app for the first time, the mitigation status of the SVDs might take a while to update. If you want to fasten things up, run the reports found in the app.

For RBAC, you can use the shipped read-only or writeable role of the app. The app does not contain or need any additional index.


New in version 2.3.1 is a report, which can be ran manually to populate a manual checks lookup. 
After running this, check the lookup in order to solve the manual checks displayed in the Splunk Security Advisories dashboard.


## The future / upcoming versions

**Version 3.1.0** is planned to have more use cases (especially for the Mitigation Report dashboard) with more checks. Other searches may be further optimized and more reports added to the MC. Don't worry, there will never be heavy load on the MC. Just simple REST searches to query all Splunk Enterprise instances from a cluster every few hours. 
Right now, the app does not contain any alerts. I plan to include (disabled) alerts, e.g. for new vulnerabilities which aren't fixed in the current version. That way you don't have to check the dashboards preemptively.

** Version 3.2.0** will have more version checks for its lookups and several use cases, so it will be more modular and easier to update its content by scripts without requiring to update the app or add-ons manually.
