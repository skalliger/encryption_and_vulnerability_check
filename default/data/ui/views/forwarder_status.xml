
<dashboard version="2" theme="dark">
    <label>Forwarder Status</label>
    <description>Displays information about Splunk forwarders. Especially useful when migrating from splunktcp to splunktcp-ssl.</description>
    <definition><![CDATA[
{
	"visualizations": {
		"viz_amFfaDuE": {
			"type": "splunk.pie",
			"dataSources": {
				"primary": "ds_nrYt7Bya"
			},
			"title": "Forwarder TLS Distribution"
		},
		"viz_vbxtlvOZ": {
			"type": "splunk.table",
			"dataSources": {
				"primary": "ds_71IsOZDx"
			},
			"title": "Forwarder List",
			"description": "can be filtered",
			"options": {
				"columnFormat": {
					"Encryption enabled": {
						"data": "> table | seriesByName(\"Encryption enabled\") | formatByType(Encryption_enabledColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('Encryption enabled') | pick(Encryption_enabledRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"Encryption enabled\") | matchValue(Encryption_enabledRowBackgroundColorsEditorConfig)"
					}
				}
			},
			"context": {
				"Encryption_enabledColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"Encryption_enabledRowColorsEditorConfig": [
					"#ffffff"
				],
				"Encryption_enabledRowBackgroundColorsEditorConfig": [
					{
						"match": "false",
						"value": "#78062a"
					},
					{
						"match": "true",
						"value": "#2f8811"
					}
				]
			}
		},
		"viz_U19u3FxW": {
			"type": "splunk.table",
			"title": "Possible Configuration Errors",
			"description": "can be filtered by Host or Log Level",
			"dataSources": {
				"primary": "ds_fCwPuogH"
			},
			"options": {
				"columnFormat": {
					"log_level": {
						"data": "> table | seriesByName(\"log_level\") | formatByType(log_levelColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('log_level') | pick(log_levelRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"log_level\") | matchValue(log_levelRowBackgroundColorsEditorConfig)"
					}
				}
			},
			"context": {
				"log_levelColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"log_levelRowColorsEditorConfig": [
					"#ffffff"
				],
				"log_levelRowBackgroundColorsEditorConfig": [
					{
						"match": "INFO",
						"value": "#2f8811"
					},
					{
						"match": "WARN",
						"value": "#ad3f20"
					},
					{
						"match": "ERROR",
						"value": "#78062a"
					}
				]
			}
		},
		"viz_pa4LJCtd": {
			"type": "splunk.table",
			"dataSources": {
				"primary": "ds_vOdH1Sx1"
			},
			"title": "Splunk 9 TLS Config Warnings",
			"options": {
				"columnFormat": {
					"log_level": {
						"data": "> table | seriesByName(\"log_level\") | formatByType(log_levelColumnFormatEditorConfig)",
						"rowColors": "> table | seriesByName('log_level') | pick(log_levelRowColorsEditorConfig)",
						"rowBackgroundColors": "> table | seriesByName(\"log_level\") | matchValue(log_levelRowBackgroundColorsEditorConfig)"
					}
				}
			},
			"context": {
				"log_levelColumnFormatEditorConfig": {
					"string": {
						"unitPosition": "after"
					}
				},
				"log_levelRowColorsEditorConfig": [
					"#ffffff"
				],
				"log_levelRowBackgroundColorsEditorConfig": [
					{
						"match": "INFO",
						"value": "#2f8811"
					},
					{
						"match": "WARN",
						"value": "#ad3f20"
					},
					{
						"match": "ERROR",
						"value": "#78062a"
					}
				]
			}
		}
	},
	"dataSources": {
		"ds_Rl9yEA47": {
			"type": "ds.search",
			"options": {
				"query": "index=_internal source=*metrics.log* group=tcpin_connections host=\"$tok_host$\"\n| fields hostname, version, sourceIp, destPort, ssl, sourceHost, os, arch, fwdType",
				"queryParameters": {
					"earliest": "$global_time.earliest$",
					"latest": "$global_time.latest$"
				}
			},
			"name": "Get_all_FWs"
		},
		"ds_nrYt7Bya": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_Rl9yEA47",
				"query": "| dedup hostname \n| stats count by ssl\n| rename ssl AS \"Encryption enabled\""
			},
			"name": "fw_tls_distribution"
		},
		"ds_71IsOZDx": {
			"type": "ds.chain",
			"options": {
				"extend": "ds_Rl9yEA47",
				"query": "| dedup hostname\n| table hostname version sourceIp destPort ssl, fwdType, os, arch\n| rename hostname AS \"Host\", version AS \"Splunk Version\", sourceIp AS \"Source IP address\", destPort AS \"Destination Port\", ssl AS \"Encryption enabled\""
			},
			"name": "list_FWs_tls"
		},
		"ds_fCwPuogH": {
			"type": "ds.search",
			"options": {
				"query": "index=_internal sourcetype=splunkd component=TCPOutputProc log_level IN ($tok_log_level$) \"SSL\" host=\"$tok_host$\"\n| fields _time, log_level, host, component, event_message\n| dedup host, event_message\n| transaction host\n| table _time, log_level, host, component, event_message\n| rename event_message AS \"Message\", log_level AS \"Log Level\", host as Host, component AS \"Log Channel\"",
				"queryParameters": {
					"earliest": "$global_time.earliest$",
					"latest": "$global_time.latest$"
				}
			},
			"name": "Get_tls_errors"
		},
		"ds_vOdH1Sx1": {
			"type": "ds.search",
			"options": {
				"query": "index=_internal sourcetype=splunkd component IN (\"x509verify\", \"SSLOptions\", \"SSLCommon\") log_level IN ($tok_log_level$) host=\"$tok_host$\"\n| fields _time, log_level, host, component, event_message\n| stats values(event_message) AS Message by _time, log_level, host, component\n| transaction host component\n| fields _time, log_level, host, component, Message, eventcount\n| fields - _raw\n| rename host as Host, component AS \"Log Channel\",  log_level AS \"Log Level\",",
				"queryParameters": {
					"earliest": "$global_time.earliest$",
					"latest": "$global_time.latest$"
				}
			},
			"name": "Get_default_v9_config_warnings"
		}
	},
	"defaults": {
		"dataSources": {
			"ds.search": {
				"options": {
					"queryParameters": {
						"latest": "$global_time.latest$",
						"earliest": "$global_time.earliest$"
					}
				}
			}
		}
	},
	"inputs": {
		"input_global_trp": {
			"type": "input.timerange",
			"options": {
				"token": "global_time",
				"defaultValue": "-60m@m,now"
			},
			"title": "Global Time Range"
		},
		"input_pBkF9cFF": {
			"options": {
				"defaultValue": "*",
				"token": "tok_host"
			},
			"title": "Enter a Hostname",
			"type": "input.text"
		},
		"input_UEG7e4q4": {
			"options": {
				"items": [
					{
						"label": "Errors",
						"value": "ERROR"
					},
					{
						"label": "Warnings",
						"value": "WARN"
					},
					{
						"label": "Informational",
						"value": "INFO"
					}
				],
				"defaultValue": [
					"ERROR",
					"WARN"
				],
				"token": "tok_log_level"
			},
			"title": "Select Log Levels",
			"type": "input.multiselect"
		}
	},
	"layout": {
		"type": "grid",
		"options": {},
		"structure": [
			{
				"item": "viz_amFfaDuE",
				"type": "block",
				"position": {
					"x": 0,
					"y": 0,
					"w": 600,
					"h": 400
				}
			},
			{
				"item": "viz_U19u3FxW",
				"type": "block",
				"position": {
					"x": 0,
					"y": 400,
					"w": 1200,
					"h": 400
				}
			},
			{
				"item": "viz_vbxtlvOZ",
				"type": "block",
				"position": {
					"x": 600,
					"y": 0,
					"w": 600,
					"h": 400
				}
			},
			{
				"item": "viz_pa4LJCtd",
				"type": "block",
				"position": {
					"x": 0,
					"y": 800,
					"w": 1200,
					"h": 400
				}
			}
		],
		"globalInputs": [
			"input_global_trp",
			"input_pBkF9cFF",
			"input_UEG7e4q4"
		]
	},
	"description": "Displays information about Splunk forwarders. Especially useful when migrating from splunktcp to splunktcp-ssl.",
	"title": "Forwarder Status"
}
    ]]></definition>
    <meta type="hiddenElements"><![CDATA[
{
	"hideEdit": false,
	"hideOpenInSearch": false,
	"hideExport": false
}
    ]]></meta>
</dashboard>